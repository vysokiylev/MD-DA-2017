---
title: "lab3"
author: "Lev Vysokiy"
date: '17 октября 2017 г '
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**Задание 1**
1. Используйте команду readLines для загрузки файла в текстовый вектор html.
Сколько строк в файле?
Сколько символов в файле?
```{r}
html <- readLines('https://raw.githubusercontent.com/SergeyMirvoda/MD-DA-2017/master/data/forbes.htm');
length(html);
sum(nchar(html));
```
1991 строка
80380 символов
2. Откройте файл в текстовом редакторе. Найдите строки, содержащие данные о Билле Гейтсе и Ларри Эллисоне и запомните размер их дохода.
3. Напишите шаблон регулярного выражения и используйте функцию grep, чтобы извлечь размер дохода из данных в векторе html. Удостоверьтесь, что полученный вектор номеров строк содержит содержит ровно 100 записей и ссылается на номера строк в котрых действительно есть информация о доходе, а не просто первый попавшийся текст.
```{r}
grep("\\$[0-9]{1, }\\sB|\\$[0-9]{1,}\\,[0-9]{1,}\\sB", html)
```
4. Напишите код, использовав регулярное выражение из п. 3, и функции regexp и regmatches, чтобы извлечь все данные о доходе. Проверьте следующее:
Должно быть ровно сто значений.
Самый большой доход должен быть доход Билла Гейтса
Такой доход должен быть в списке один раз.
В всписке должна быть цифра, которую мы запомнили для Ларри Эллисона.
Должно быть как минимум два значения, встречающихся несколько раз.
```{r}
matches <- regmatches(html,regexpr("\\$[0-9]{1, }\\sB|\\$[0-9]{1,}\\,[0-9]{1,}\\sB", html));
print(matches);
```
**Задание 2**
5. В данных доход представлен в формате "$42 B", что означает 42 × 10^9. Преобразуйте этот формат в числовой и сохраните в вектор worths. Удостоверьтесь в следующем:
-worths является вектором и в нём сто занчений типа double.
-Все элементы вектора worths больше 1 миллиарда.
-Самое большое число это доход Билла Гейтса.
```{r}
strValues <- regmatches(matches,regexpr("[0-9]{1, }|[0-9]{1,}\\,[0-9]{1,}", matches));
replaced <- gsub(",", ".", strValues);
worths <- as.numeric(replaced) * 10^9;
print(worths);
```
6. Используйте вектор worths , чтобы выяснить следующее:
Какова медиана ста этих записей?
Средний доход?
Как много людей из этого списка имеют доход больше 5млрд., 10, 25?
Какой их общий доход?
Какую долю от общего дохода, составляет пятёрка самых богатых.
Какую долю от общего дохода, составляют 20 самых богатых.
В данных федерального резерва США найдите показатель дохода всех домохозяйств (Household net worth) в соответвующем году, какую долю общего дохода составляют 100 богатейших людей.
```{r}
median(worths); #медиана
mean(worths); #среднее
length(worths[worths > 5*10^9]); #доход больше 5млрд
length(worths[worths > 10*10^9]); #доход больше 10млрд
length(worths[worths > 25*10^9]); #доход больше 25млрд
allSum <- sum(worths); #общий доход 
first5sum <- sum(worths[1:5]); #сумма первых 5
shareOfFirst5 <- first5sum/allSum; #доля первых 5
print(shareOfFirst5);
first20sum <- sum(worths[1:20]); #сумма первых 20
shareOfFirst20 <- first20sum/allSum; #доля первых 20
print(shareOfFirst20);
householdNetWorth <- 78536 * 10^9; #доход всех домохозяйств
shareOfHousehold <- allSum/householdNetWorth; #доход от всех домохозяйств
print(shareOfHousehold);
```